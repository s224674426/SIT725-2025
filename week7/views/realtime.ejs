<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title><%= title %></title>
  <style>body{font-family:system-ui;margin:2rem} #status{background:#f5f5f5;padding:.4rem .6rem;border-radius:8px;display:inline-block}</style>
</head>
<body>
  <h1>Realtime Demo</h1>
  <div id="status">Connectingâ€¦</div>
  <ul id="chat"></ul>
  <form id="form"><input id="msg" placeholder="Type a message" autocomplete="off"/><button>Send</button></form>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const s = io();
    const status = document.getElementById('status');
    const list = document.getElementById('chat');
    const form = document.getElementById('form');
    const input = document.getElementById('msg');

    s.on('connect', () => status.textContent = 'Live updates: connected');
    s.on('disconnect', () => status.textContent = 'Live updates: offline');
    s.on('welcome', (d) => status.textContent = d.msg);
    s.on('chat:message', (m) => { const li=document.createElement('li'); li.textContent=m; list.appendChild(li); });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const v = input.value.trim();
      if (v) s.emit('chat:message', v);
      input.value = '';
    });
  </script>
</body>
</html>
